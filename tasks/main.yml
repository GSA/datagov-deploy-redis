---
  - name: Include redis version
    include_vars:
      file: vars/version.yml

  - name: Remove OS redis packages
    become: true
    package:
      name: "{{ item }}"
      state: absent
    with_items:
      - "redis-server"
      - "redis-tools"

  - name: Set redis password from vault
    set_fact:
      redis_password: "{{ vault_catalog_db_pass }}"
    when: vault_catalog_db_pass is defined

  - name: Import ansible-redis role
    become: true
    import_role:
      name: vendor/davidwittman.redis
